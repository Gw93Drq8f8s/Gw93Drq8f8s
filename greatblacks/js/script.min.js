let djangoField=document.getElementById("id_username");djangoField&&(djangoField.id="id_username1"),axios.defaults.xsrfCookieName="csrftoken",axios.defaults.xsrfHeaderName="X-CSRFTOKEN";let static_root=document.getElementById("static_root"),static_dir="";static_root&&(static_dir=static_root.innerText,static_root.remove()),Vue.component("imagelist-component",{props:{name:{type:String,value:String},url:{type:String,value:String}},delimiters:["[[","]]"],template:`<div class="responsive" @click="toggleDetails"><div class="gallery"><div class="desc">[[name]]</div><img :src="[[url]]" alt=""><div title="share" class="share"><span class="shareLogo"></span></div></div></div>;`,methods:{toggleDetails(t){t.stopPropagation();let e=document.querySelectorAll(".responsive .gallery");if(["share","shareLogo"].includes(t.target.className))blackVue.toggleShareModal(t);else if("IMG"==t.target.tagName){let a=t.target.closest(".gallery");for(let t=0;t<e.length;t++)e[t]!=a&&e[t].classList.remove("active");a.classList.toggle("active"),a.classList.contains("active")?document.querySelector(".carousel-container .description").classList.add("visible"):document.querySelector(".carousel-container .description").classList.remove("visible");const r=document.querySelector(".gallery.active img");if(r){const e=blackVue.lastBlobImages2[r.src].id;blackVue.dataImages[e]&&blackVue.dataImages[e].url&&(blackVue.blackName=blackVue.dataImages[e].name,blackVue.extracts=blackVue.shortVersionExtracts(blackVue.dataImages[e].extracts),blackVue.categories=blackVue.dataImages[e].category.join(", "),blackVue.wiki_link=blackVue.dataImages[e].wiki_link,blackVue.internal_link=blackVue.dataImages[e].internal_link,document.querySelector(".carousel-container .description-content p").scrollTop=0)}}}},computed:{}});let black_name,birth_date,birth_place,death_date,death_place,wikiName,imageName,country,occupation,known_for,category,summary,image_url,blackVue=new Vue({delimiters:["[[","]]"],el:"#app",data:{username:document.getElementById("user-username").innerHTML,authenticated:"True"==document.getElementById("isAuthenticated").innerHTML,currentAddTab:0,animationChecks:!0,wikiLinkChange:!0,addSubmited:!1,waitForPromise:!1,carousel:null,cardsContainer:null,cardsCarousel:null,cardsController:null,beforedatavalidated:null,lastScrollDirection:{direction:"",srcChanged:!0,cursorState:null},onePixelUrl:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR4nGNiYAAAAAkAAxkR2eQAAAAASUVORK5CYII=",blackName:"",extracts:"",countryCode:null,categories:"",internal_link:window.location.origin+"/",wiki_link:"#",queryPeriod:[null,null],queryCategory:["activist","scientist","politic","art","sport","spiritual","other"],listMarkers:{},blacksData:null,currentYear:new Date().getFullYear(),timeLine:[],dataImages:[],dataImagesComponent:[],dataImages_lastIndex:0,dataImagesComponent_backup:[],slug:"",isDeath:!0,isMobile:/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||500>document.querySelector(".carousel-container").clientWidth,openPolygon_timeStamp:Date.now(),postAxiosResponses:[],tempBlobImage:"",objectURL:window.URL||window.webkitURL,objectURL2:window.URL||window.webkitURL,lastBlobImages:{count:[]},lastBlobImages2:{},isViewModeList:!1,filterSearchValue:""},methods:{addListImages:function(){let e=document.querySelector(".carousel-container .list");e.style.display="block",0==this.dataImagesComponent.length&&(this.dataImagesComponent=this.changeDataUriToBlob(this.dataImages.slice(0,4)),this.dataImages_lastIndex=4,e.onscroll=this.loadNext20Images)},loadNext20Images:function(){let e=document.querySelector(".carousel-container .list");e.scrollTop>=.75*(e.scrollHeight-e.offsetHeight)&&0<e.children.length&&blackVue.dataImages_lastIndex<blackVue.dataImages.length&&300<e.scrollTop&&(blackVue.dataImages_lastIndex+=20,blackVue.dataImagesComponent=blackVue.changeDataUriToBlob(blackVue.dataImages.slice(0,blackVue.dataImages_lastIndex)))},changeDataUriToBlob:function(e){let t=JSON.parse(JSON.stringify(e));for(let a=0;a<e.length;a++)if(e[a].url.startsWith("data:image/octet-stream;base64,")){let r=this.getCleanImage2(e[a].url);t[a].url=r}return t},toggleMenu:function(){this.closeOtherStuff();let e=document.getElementById("menuLinks");"block"===e.style.display?(e.style.display="none",document.getElementById("content").style.opacity="1"):(e.style.display="block",document.getElementById("content").style.opacity="0.1",event.stopPropagation(),document.querySelector(".container").addEventListener("click",function t(){e.style.display="none",document.getElementById("content").style.opacity="1",this.removeEventListener("click",t)}))},menuItem:function(t){this.closeOtherStuff();let e=t.target.dataset.link;if("greatblacks"==e)document.getElementById("map").style.display="block",this.authenticated&&(document.getElementById("myAccount").style.display="none");else if("myAccount"==e){if(this.authenticated)document.getElementById("map").style.display="none",document.getElementById("myAccount").style.display="block",document.getElementById("add").click();else{let e=document.getElementById("loginModal");this.toggleModal(e)}}else if("api"==e)window.open(window.location.origin+"/api/","_blank");else if("about"==e){let e=document.getElementById("aboutModal");this.toggleModal(e)}else if("logout"==e){let e=this;axios.get(window.location.origin+"/logout/?redirect=no").then(t=>{t.data&&"success"==t.data.status&&(e.authenticated=!1,document.querySelector("#menuLinks a[data-link=\"greatblacks\"]").click())},e=>{console.log("error",e)})}},toggleModal:function(e,...t){e.classList.toggle("active"),e.classList.contains("active")?(0<t.length?this.closeOtherStuff(e,...t):this.closeOtherStuff(e),document.querySelector(".container").style.opacity="0.2","loginModal"!=e.id&&(window.onclick=function(t){t.target==e&&(e.classList.remove("active"),document.querySelector(".container").style.opacity="1")})):document.querySelector(".container").style.opacity="1"},closeModal:function(t){let e=t.target,a=e.closest(".modal");a.classList.remove("active"),document.querySelector(".container").style.opacity="1","showcase"==a.id&&this.updateSlug(!0)},closeOtherStuff:function(e,...t){const a=["showcase","aboutModal","loginModal","share-modal"];let r=[];t&&Array.isArray(t)&&0<t.length?(r=t.map(e=>e.id),r.push(e.id)):e&&0==t.length&&(r=Array(e.id));for(let n=0;n<a.length;n++){const t=document.querySelector("#"+a[n]);e?t&&!r.includes(a[n])&&t.classList.remove("active"):t&&t.classList.remove("active")}!e&&(this.carousel||"hidden"!=document.querySelector(".carousel-container").style.visibility)&&document.querySelector(".container").click()},openTab:function(t){let e,a,r,n=t.target.closest("button");for(a=document.getElementsByClassName("tabcontent"),e=0;e<a.length;e++)a[e].style.display="none";for(r=document.getElementsByClassName("tablink"),e=0;e<r.length;e++)r[e].classList.remove("active");document.querySelector(".tabcontent[data-tab="+n.id+"]").style.display="block",n.classList.add("active"),"add"==n.id&&this.addSubmited&&(this.resetAddTabAfterSubmit(),this.addSubmited=!1)},resetAddTabAfterSubmit:function(){this.afterWikiRequest("show",null,!0),document.querySelectorAll(".container-add .confirmation img.addGifSuccessOrError").forEach(t=>t.parentNode.removeChild(t)),document.querySelector(".container-add .confirmation div.message").innerHTML="",this.currentAddTab=1,this.nextPrev(-1),this.initAddGreatBlack(null,!1),document.querySelector(".confirm-details .photo img").src=this.onePixelUrl},switchLoginTab:function(t){let e=t.target;"logInTab"==e.id?(document.getElementById("signInTab").className="",document.querySelector(".formRegister").style.display="none",document.querySelector("#signInTab").style.opacity="0.5",document.querySelector("#logInTab").style.opacity="1",document.querySelector(".formLogin").style.display="block"):(document.getElementById("logInTab").className="",document.querySelector(".formLogin").style.display="none",document.querySelector("#logInTab").style.opacity="0.5",document.querySelector("#signInTab").style.opacity="1",document.querySelector(".formRegister").style.display="block"),e.className="activeTab",document.getElementById("loginMessage").innerHTML=""},loginFormSubmit:function(t){let e="";const a={username:t.target.querySelector("input[name=\"username\"]").value};if("formLogin"==t.target.className)e="/login/",a.password=t.target.querySelector("input[name=\"password\"]").value;else if("formRegister"==t.target.className){e="/register/",a.password1=t.target.querySelector("input[name=\"password1\"]").value,a.password2=t.target.querySelector("input[name=\"password2\"]").value;let r=document.querySelector("#loginModal .formRegister .terms > input[name=\"terms\"]");if(!r.checked)return r.closest(".terms").classList.add("error"),r.onclick=function(){r.closest(".terms").classList.remove("error")},!1;if(a.password1!=a.password2)return document.getElementById("loginMessage").innerHTML="The passwords are not identical.",!1;if(6>a.password1.length)return document.getElementById("loginMessage").innerHTML="Password must be greater than 5 characters.",!1}let r=this;e&&this.postAxios(window.location.origin+e,a,function(e){if(e.data&&"success"==e.data.status){r.authenticated=!0,r.username=e.data.user,"formLogin"==t.target.className&&r.getUserData(),setTimeout(()=>{document.getElementById("map").style.display="none",document.getElementById("myAccount").style.display="block"},0),document.querySelector(".container").style.opacity="1";let a=document.querySelector("#loginModal .formLogin input[name=\"username\"]");a&&(a.value="");let n=document.querySelector("#loginModal .formLogin input[name=\"password\"]");n&&(n.value="");let l=document.querySelector("#loginModal .formRegister input[name=\"username\"]");l&&(l.value="");let s=document.querySelector("#loginModal .formRegister input[name=\"password1\"]");s&&(s.value="");let o=document.querySelector("#loginModal .formRegister input[name=\"password2\"]");o&&(o.value="")}else null!=e.data.message&&(document.getElementById("loginMessage").innerHTML=e.data.message)})},alertRecovery:function(){alert("Forgot your password?\nDon't take the hassle out of it, create a new account!")},changePassword:function(){let e=document.querySelector(".changePassword input[name=current-password]").value,t=document.querySelector(".changePassword input[name=new-password]").value;if(6>e.length||6>t.length)return document.querySelector("#changePasswordMessage").innerHTML="<span class=\"red\">Password must be greater than 5 characters.</span>",!1;const a={username:this.username,password:e,new_password:t};this.postAxios(window.location.origin+"/changePassword/",a,function(e){e.data&&"success"==e.data.status?(document.querySelector("#changePasswordMessage").innerHTML="<span class=\"green\">Passsword Changed successfully.</span>",document.querySelector(".changePassword input[name=current-password]").value="",document.querySelector(".changePassword input[name=new-password]").value=""):e.data.message!=null&&""!=e.data.message?document.querySelector("#changePasswordMessage").innerHTML="<span class=\"red\">"+e.data.message+"</span>":document.querySelector("#changePasswordMessage").innerHTML="<span class=\"red\">Password change was not successful.</span>"})},generateToken:function(){if(document.querySelector(".apiKey #apikeyMessage").innerHTML="","disabled"!=document.querySelector(".apiKey button#generateToken").className){const e={username:this.username};this.postAxios(window.location.origin+"/generateToken/",e,function(e){if(e.data&&"success"==e.data.status){let t=document.querySelector(".apiKey .token input.input-token");t&&(t.value=e.data.token);let a=document.querySelector(".apiKey button#generateToken");a&&(a.className="disabled")}else document.querySelector(".apiKey #apikeyMessage").innerHTML="<span class=\"red\">Something went wrong, please try again.</span>"})}},copyToken:function(){""==document.querySelector(".apiKey .token input.input-token").value||(document.querySelector(".apiKey .token input.input-token").select(),document.execCommand("copy"))},deleteToken:function(){if(""==document.querySelector(".apiKey .token input.input-token").value)return;let e=this;document.querySelector(".apiKey .token button.delete").style.display="none",document.querySelector("#undo").style.display="initial";let t=document.querySelector(".apiKey .token input.input-token").value;document.querySelector(".apiKey .token input.input-token").value="";const a={username:this.username};let r=setTimeout(function(){e.postAxios(window.location.origin+"/deleteToken/",a,function(e){document.querySelector(".apiKey .token button.delete").style.display="initial",document.querySelector("#undo").style.display="none",e.data&&"success"==e.data.status&&(document.querySelector(".apiKey button#generateToken").className="generateToken",document.querySelector(".apiKey .token input.input-token").value="")})},5e3);document.querySelector("#undo").onclick=function(){clearTimeout(r),document.querySelector(".apiKey .token button.delete").style.display="initial",document.querySelector("#undo").style.display="none",document.querySelector(".apiKey .token input.input-token").value=t}},deleteMyAccount:function(){let e=document.querySelector(".delete-account input").value;const t={username:this.username,password:e};""!=e&&6<=e.length&&this.postAxios(window.location.origin+"/deleteAccount/",t,function(e){e.data&&"success"==e.data.status&&window.location.reload()})},getUserData:function(){const e={username:this.username};this.postAxios(window.location.origin+"/getUserData/",e,function(e){if(e.data&&e.data.token&&"success"==e.data.token.status&&""!=e.data.token.token?(document.querySelector(".apiKey .token input.input-token").value=e.data.token.token,document.querySelector(".apiKey button#generateToken").className="disabled"):(document.querySelector(".apiKey button#generateToken").className="generateToken",document.querySelector(".apiKey .token input.input-token").value=""),e.data&&e.data.history&&"success"==e.data.history.status&&""!=e.data.history.list){document.querySelectorAll(".container-history li.table-row").forEach(e=>{e.remove()});let t=[];try{t=JSON.parse(e.data.history.list)}catch{console.log("JSON Error")}let a="";for(let e,r=t.length-1;0<=r;r--){e="PENDING",2==parseInt(t[r].status)?e="<span class=\"greenLigth\">COMPLETED</span>":3==parseInt(t[r].status)&&(e="<span class=\"red\">DECLINED</span>");const n=e.match("COMPLETED")?"<a href=\""+t[r].internal_link+"\">"+t[r].name+"</a>":t[r].name;a+="<li class=\"table-row\"><div data-label=\"Id\" class=\"col col-1\">"+(r+1)+"</div> <div data-label=\"Name\" class=\"col col-2\">"+n+"</div> <div data-label=\"Date\" class=\"col col-3\">"+t[r].date+"</div> <div data-label=\"Status\" class=\"col col-4\">"+e+"</div></li>"}const r=document.querySelector(".container-history ul").innerHTML;document.querySelector(".container-history ul").innerHTML=r+a}})},initAddGreatBlack:function(t,e=!0){!0==e?(document.querySelector(".container-add button#add-new-black").style.display="none",document.querySelector(".container-add #addForm").style.display="initial",this.showAddTab(this.currentAddTab)):(document.querySelector(".container-add button#add-new-black").style.display="initial",document.querySelector(".container-add #addForm").style.display="none",this.currentAddTab=0,document.querySelector("#addForm input#wiki-link").value="");let a=document.querySelector("#addWiki-loading");a.classList.contains("loaded")||(a.classList.add("loaded"),a.src=static_dir+"greatblacks/images/loading.gif")},showAddTab:function(e){let t=document.querySelectorAll(".container-add .tab");t[e].style.display="block",document.getElementById("prevBtn").style.display=0==e?"none":"inline",document.getElementById("nextBtn").innerHTML=e==t.length-1?"Submit":"Next"},nextPrev:function(e){if("stop"==blackVue.wikiLinkChange||this.addSubmited)return!1;let t=document.getElementsByClassName("tab"),a=this.validateAddForm(e);return!!(1!=e||a)&&(t[this.currentAddTab].style.display="none",this.currentAddTab+=e,this.currentAddTab>=t.length?(a&&document.getElementById("addForm").submit(),!1):void this.showAddTab(this.currentAddTab))},onConfirmDetails:function(){const e="none"===window.getComputedStyle(document.querySelector(".container-add #prevBtn")).display;return!e},validateDate:function(e){event&&"change"==event.type&&(e=event.target);const t=new Date,a=t.getFullYear();let r=!1;const n=e.value.trim().match(/^(([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})$)|^([0-9]{4}$)|^(-[0-9]+$)/);return null!=n&&(r=!0,null!=n[1]&&(null!=n[2]&&null!=n[3]&&null!=n[4]?(Date.parse(n[1])>t&&(r=!1),!(parseInt(n[2])<=a&&0<=parseInt(n[2])&&12>=parseInt(n[3])&&0<parseInt(n[3])&&31>=parseInt(n[4])&&0<parseInt(n[4]))&&(r=!1)):r=!1),null!=n[5]&&!(parseInt(n[5])<=a&&0<=parseInt(n[5]))&&(r=!1),null!=n[6]&&!(0>parseInt(n[6]))&&(r=!1)),"death"==e.attributes.name.value&&""==e.value.trim()&&(r=!0),"born"==e.attributes.name.value&&(r?(this.toggleCheckIcon("born","dataUri-check-circle"),e.classList.remove("invalid")):this.toggleCheckIcon("born","dataUri-times-circle")),"death"==e.attributes.name.value&&(r?(this.toggleCheckIcon("death","dataUri-check-circle"),e.classList.remove("invalid")):this.toggleCheckIcon("death","dataUri-times-circle")),r},validateAddForm:function(e,t=!1){document.querySelectorAll(".tab span.red").forEach(e=>{e.innerHTML=""});let a,r,n,l=!0;for(a=document.getElementsByClassName("tab")[this.currentAddTab],r=a.querySelectorAll("input[type=\"text\"]"),n=0;n<r.length&&"wiki-link"!=r[0].id;n++){let e=!0;if(r[n].classList.remove("invalid"),null!=r[n].attributes.readonly)continue;("born"==r[n].attributes.name.value||"death"==r[n].attributes.name.value)&&(e=this.validateDate(r[n])),"country"==r[n].attributes.name.value&&(null==r[n].value.trim().match(/^[a-z][a-z \.-]+$/i)||50<r[n].value.length)&&(e=!1),"disabled"==r[n].className&&(e=!0);let t=r[n].nextSibling;""==r[n].value&&null!=r[n].attributes.required||!1==e?(r[n].className+=" invalid",l=!1,t&&(t.className="dataUri-times-circle")):t&&(t.className="dataUri-check-circle")}0==document.querySelectorAll(".confirm-details ul[name=\"category\"] input[type=\"checkbox\"]:checked").length?(l=!1,this.toggleCheckIcon("category","dataUri-times-circle")):this.toggleCheckIcon("category","dataUri-check-circle");const s=document.querySelectorAll(".confirm-details select[name=\"country\"] option:checked");if(0==s.length||3<s.length||""==s[0].value?(l=!1,this.toggleCheckIcon("country","dataUri-times-circle")):this.toggleCheckIcon("country","dataUri-check-circle"),t||null==document.querySelector("#nextBtn.disabled")||(l=!1),null!=a)if("addWikiLink"==a.dataset.name){if(document.querySelector(".container-add .preview .image").innerHTML="",document.querySelector(".container-add .preview .link").innerHTML="",null==r[0].value.trim().match(/^https:\/\/[a-zA-Z-.]+\.wikipedia\.org\/wiki\/[^\s]+$/))l=!1,a.querySelector("span.red").innerHTML="Please provide a Wikipedia link.";else{if(a.querySelector("span.red").innerHTML="",!0==blackVue.wikiLinkChange){black_name=birth_date=birth_place=death_date=death_place=wikiName=country=imageName=image_url=occupation=known_for=category=summary=void 0;const e=r[0].value.trim().replace(/.*\//,"").replace(/#.*/,"").replace(/\?.*/,""),t="https://en.wikipedia.org/w/api.php?format=json&action=query&prop=extracts|revisions|pageimages|imageinfo&rvslots=main&rvprop=content&rvsection=0&pithumbsize=400&exintro&explaintext&redirects=1&titles="+decodeURIComponent(e);return blackVue.fetchAsScript(decodeURIComponent(e),t,"checkWiki1","checkWikiData1"),document.querySelector(".tab[data-name=\"addWikiLink\"]").style.display="none",document.querySelector("#addForm button#nextBtn").style.display="none",document.querySelector("#addWiki-loading").style.display="initial",blackVue.wikiLinkChange=!1,!1}return blackVue.confirmDetailsInfos(),!1}}else if("confirm-details"==a.dataset.name&&!0==l&&!blackVue.addSubmited){if(1!=e||!blackVue.onConfirmDetails())return!1;document.querySelector(".container-add div[data-name=\"confirm-details\"]").style.display="none",document.querySelector("#addForm button#prevBtn").style.display="none",document.querySelector("#addForm button#nextBtn").style.display="none",document.querySelector("#addWiki-loading").style.display="initial",category=null==category?"":category.substring(0,100)+"|",document.querySelectorAll(".confirm-details .checkboxList input[type=\"checkbox\"]").forEach(e=>{category+=e.checked?e.name+",":""}),category=category.replace(/\|$/,"").replace(/,$/,"");let t=[];document.querySelectorAll(".confirm-details select[name=\"country\"] option:checked").forEach(e=>{t.push(e.value)});const a={wikiName:wikiName?decodeURIComponent(wikiName.replace(/\s/g,"_")):null,image_url:image_url||null,summary:summary||null,black_name:black_name?decodeURIComponent(black_name.replace(/_/g," ")):wikiName?decodeURIComponent(wikiName.replace(/_/g," ")):null,birth_date:birth_date||document.querySelector(".confirm-details input[name=\"born\"]").value,death_date:death_date||document.querySelector(".confirm-details input[name=\"death\"]").value,country_user:t,country_wiki:country||null,category:category||null};return this.submitNewGreatBlack(a),!1}return l},formatStrDate:function(e){e=e.replace(/\(.*\)/,"");let t=new Date(e);if(t&&!isNaN(t.getTime())){let e=""+(t.getMonth()+1),a=""+t.getDate(),r=t.getFullYear();return 2>e.length&&(e="0"+e),2>a.length&&(a="0"+a),[r,e,a].join("-")}return""},checkWikiData1:function(e){const t=e.query.pages,a=Object.keys(e.query.pages)[0];if(wikiName=decodeURIComponent(document.querySelector("#checkWiki1").dataset.wikiName),-1!=a){let r;imageName=t[a].pageimage;try{if(r=t[a].revisions[0].slots.main["*"],r=r.replace(/\\n/g,"\\").replace(/[↵\r\n]/g,"\\"),null==imageName){let e=r.match(/\|\s*image\s*=([^\\<]+)/i);null!=e&&""!=e[1].trim()&&null==imageName&&(imageName=encodeURIComponent(e[1].trim().replace(/ /g,"_")))}}catch(t){return void console.log(t)}e.query.redirects&&(wikiName=e.query.redirects[0].to.replace(/\s/g,"_")),black_name=t[a].title,summary=t[a].extract;let n=!1;if(null!=t[a].thumbnail)image_url=t[a].thumbnail.source;else if(null!=imageName){n=!0;const e="https://en.wikipedia.org/w/api.php?format=json&action=query&titles=Image:"+imageName+"&prop=imageinfo&iiprop=url";blackVue.fetchAsScript("imageName",e,"checkWikiImage2","checkWikiImage2")}if(null!=t[a].revisions&&r){let e=r.match(/\|\s*name\s*=([^\n\\<]+)/i),t=r.match(/\|\s*image\s*=([^\\<]+)/i),a=r.match(/\|\s*birth_date\s*=\s*([^}\\<]+)/i),l=r.match(/\|\s*birth_place\s*=([^\\<]+)/i),s=r.match(/\|\s*death_date\s*=\s*([^}\\<]+)/i),o=r.match(/\|\s*death_place\s*=([^\\<]+)/i),c=r.match(/\|\s*occupation\s*=([^\\<]+)/i),d=r.match(/\|\s*known_for\s*=([^\\<]+)/i);if(null!=e&&null==black_name&&(black_name=e[1].replace(/[\[\]{}|]/g,"").trim()),null!=a){let e=blackVue.formatStrDate(a[1]);birth_date=""==e?a[1].replace(/[^0-9]*\|/,"").replace(/\|[^0-9]*$/,"").replace(/ [^\|]*/,"").replace(/\|/g,"-").replace(/[^0-9-]*/g,"").trim():e}if(null!=l&&(birth_place=l[1].replace(/.*, /,"").replace(/.*\|/,"").replace(/[\[\]{}|]/g,"").replace(/[0-9]/g,"").trim()),imageName||null==t||""==t[1].trim()||null!=imageName||(imageName=encodeURIComponent(t[1].trim().replace(/ /g,"_"))),null!=s&&""!=s[1].trim()){let e=blackVue.formatStrDate(s[1]);death_date=""==e?s[1].replace(/[^0-9]*\|/,"").replace(/\|[^0-9]*$/,"").replace(/\|/g,"-").replace("-"+birth_date,"").replace(/[^0-9-]*/g,"").trim():e}return null!=o&&""!=o[1].trim()&&(death_place=o[1].replace(/.*, /,"").replace(/.*\|/,"").replace(/[\[\]{}|]/g,"").replace(/[0-9]/g,"").trim()),null!=c&&""!=c[1].trim()&&(occupation=c[1].replace(/[\[\]{}|]/g,"").trim(),category=occupation+","),null!=d&&""!=d[1].trim()&&(known_for=d[1].replace(/[\[\]{}|]/g,"").trim(),category=null==occupation?category:occupation+","+category),category=null==category?void 0:category.replace(/,$/,""),country=null!=birth_place&&birth_place!=death_place&&null!=death_place?birth_place+","+death_place:birth_place,void(image_url?blackVue.checkDatabase():!n&&blackVue.afterWikiRequest("show","Sorry I couldn't find a picture of the person.",!0))}}else blackVue.afterWikiRequest("show","Sorry, this wikipedia page does not seem to exist.",!0)},checkWikiImage2:function(e){const t=e.query.pages;for(pageId in t)if(t[pageId].imageinfo!=null){image_url=t[pageId].imageinfo[0].url;break}image_url!=null&&""!=image_url?blackVue.checkDatabase():blackVue.afterWikiRequest("show","This link does not appear to be the page of a person with photo.",!0),blackVue.waitForPromise=!1,blackVue.afterWikiRequest(null)},checkDatabase:function(){this.postAxios(window.location.origin+"/doesGreatBlackExist/",{wiki_Name:decodeURIComponent(wikiName)},function(e){if(e.data&&"yes"==e.data.exist){if(blackVue.afterWikiRequest("show",null,"stop"),e.data&&"DECLINED"==e.data.status)return void(document.querySelector(".container-add div[data-name=\"addWikiLink\"] span.red").innerHTML="Thanks, but this link has already been submitted and declined.");let t=document.querySelector(".container-add .preview .image"),a=document.querySelector(".container-add .preview .link");document.querySelector(".container-add div[data-name=\"addWikiLink\"] span.red").innerHTML="Thanks, but this link has already been added.";let r=document.createElement("img");r.src=e.data.image,r.onload=function(){let r=document.createElement("h3");if(r.innerHTML=e.data.name,a.appendChild(r),"PENDING"==e.data.status){let e=document.createElement("div");e.innerHTML="STATUS: PENDING",a.appendChild(e)}else{let t=document.createElement("div");t.innerHTML="<a href=\""+e.data.internal_link+"\" >"+e.data.internal_link+"</a>",a.appendChild(t)}},t.appendChild(r)}else blackVue.confirmDetailsInfos(),blackVue.afterWikiRequest("",null,!1)})},confirmDetailsInfos:function(){document.querySelector(".confirm-details .photo img").src=image_url,blackVue.currentAddTab=1,blackVue.showAddTab(blackVue.currentAddTab),document.querySelectorAll(".confirm-details .details input").forEach(e=>{e.value="",e.className="",e.removeAttribute("readonly")}),document.querySelectorAll(".confirm-details .details .checkboxList li").forEach(e=>{e.querySelector("input[type=\"checkbox\"]").checked=!1,e.className="",e.removeAttribute("readonly")}),document.querySelector(".confirm-details select[name=\"country\"]").selectedIndex=-1,this.toggleCheckIcon("name","dataUri-check-circle",300),black_name?(document.querySelector(".confirm-details .details input[name=\"name\"]").value=black_name,document.querySelector(".confirm-details .details input[name=\"name\"]").className="disabled",document.querySelector(".confirm-details .details input[name=\"name\"]").setAttribute("readonly",!0)):(document.querySelector(".confirm-details .details input[name=\"name\"]").value=decodeURIComponent(wikiName).replace(/\(.*/,"").replace(/[_]/g," "),document.querySelector(".confirm-details .details input[name=\"name\"]").className="disabled",document.querySelector(".confirm-details .details input[name=\"name\"]").setAttribute("readonly",!0)),this.toggleCheckIcon("category","dataUri-times-circle",600),birth_date&&birth_date.match(/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/)?(document.querySelector(".confirm-details .details input[name=\"born\"]").value=birth_date,document.querySelector(".confirm-details .details input[name=\"born\"]").className="disabled",document.querySelector(".confirm-details .details input[name=\"born\"]").removeAttribute("required"),document.querySelector(".confirm-details .details input[name=\"born\"]").setAttribute("readonly",!0),this.toggleCheckIcon("born","dataUri-check-circle",900)):(birth_date="",this.toggleCheckIcon("born","dataUri-times-circle",900)),death_date&&death_date.match(/^\d{4}\-(0?[1-9]|1[012])\-(0?[1-9]|[12][0-9]|3[01])$/)?(document.querySelector(".confirm-details .details input[name=\"death\"]").value=death_date,document.querySelector(".confirm-details .details input[name=\"death\"]").className="disabled",document.querySelector(".confirm-details .details input[name=\"death\"]").setAttribute("readonly",!0),this.toggleCheckIcon("death","dataUri-check-circle",1200)):death_date="",this.toggleCheckIcon("country","dataUri-times-circle",1500),this.checkCategory(),this.chooseCountry()},toggleCheckIcon:function(e,t,a){a&&this.animationChecks?(setTimeout(function(){document.querySelector(".confirm-details .details i[name=\""+e+"\"]").className=t},a),this.animationChecks=!1):document.querySelector(".confirm-details .details i[name=\""+e+"\"]").className=t},afterWikiRequest:function(e,t=null,a=null){"show"==e&&(document.querySelector(".tab[data-name=\"addWikiLink\"]").style.display="block"),null!=t&&(document.querySelector(".tab[data-name=\"addWikiLink\"] span.red").innerHTML=t),null!==a&&(blackVue.wikiLinkChange=a),document.querySelector("#addForm button#nextBtn").style.display="initial",document.querySelector("#addWiki-loading").style.display="none"},clickCheckboxCategory:function(t){let e;"INPUT"==t.target.tagName?(e=t.target,e.checked=!e.checked):e=t.target.querySelector("input");null!=t.target.closest("li").attributes.readonly||(!1==e.checked?(t.target.closest("li").className="selected",e.checked=!0):(t.target.closest("li").className="",e.checked=!1),document.querySelector(".confirm-details .checkboxList input[type=\"checkbox\"][name=\"other\"]").checked&&document.querySelectorAll(".confirm-details .checkboxList input[type=\"checkbox\"]").forEach(e=>{"other"!=e.attributes.name.value&&(e.checked=!1,e.closest("li").classList.remove("selected"))}),this.checkCategory())},checkCategory:function(){0==document.querySelectorAll(".confirm-details ul[name=\"category\"] input[type=\"checkbox\"]:checked").length?this.toggleCheckIcon("category","dataUri-times-circle"):this.toggleCheckIcon("category","dataUri-check-circle")},chooseCountry:function(){const e=document.querySelectorAll(".confirm-details select[name=\"country\"] option:checked");if(!(0==e.length||3<e.length||""==e[0].value))this.toggleCheckIcon("country","dataUri-check-circle");else if(this.toggleCheckIcon("country","dataUri-times-circle"),3<e.length)return void(e[0].closest("div").parentElement.querySelector("span[title] sup").innerHTML="3 max!");document.querySelector(".confirm-details select[name=\"country\"]").closest("div").parentElement.querySelector("span[title] sup").innerHTML=""},fetchAsScript:function(e,t,a,r){null!=document.getElementById(a)&&document.getElementById(a).remove();let n=document.createElement("script");n.src=t+"&callback="+r,n.id=a,n.dataset.wikiName=e,document.body.appendChild(n)},submitNewGreatBlack:function(e){this.postAxios(window.location.origin+"/addNewGreatBlack/",e,function(e){document.querySelector("#addWiki-loading").style.display="none",blackVue.addSubmited=!0,null!=document.getElementById("addSuccess")&&document.getElementById("addSuccess").remove(),null!=document.getElementById("addError")&&document.getElementById("addError").remove();let t=document.querySelector("#addForm .confirmation");if(e.data!=null&&"success"==e.data.status){let e=document.createElement("img");e.id="addSuccess",e.className="addGifSuccessOrError",e.src=static_dir+"greatblacks/images/confirm-success.gif",e.onload=function(){this.style.display="initial",document.querySelector(".container-add .confirmation div.message").innerHTML="<span class=\"green\">The data sent has been successfully saved.</span>"},t.insertBefore(e,t.firstChild),blackVue.getUserData()}else{let e=document.createElement("img");e.id="addError",e.className="addGifSuccessOrError",e.src=static_dir+"greatblacks/images/confirm-error.gif",e.onload=function(){this.style.display="initial",document.querySelector(".container-add .confirmation div.message").innerHTML="<span class=\"red\">The data sent could not be successfully validated.</span>"},t.insertBefore(e,t.firstChild)}})},postAxios:function(e,t,a){let r=JSON.stringify(e)+JSON.stringify(t);r in this.postAxiosResponses?a(this.postAxiosResponses[r]):axios.post(e,t,{headers:{method:"POST",accept:"*/*","content-type":"application/json;charset=UTF-8"}}).then(e=>{e&&e.data&&e.data.status&&"success"==e.data.status&&(blackVue.postAxiosResponses[r]=e),a(e)},e=>{console.log("error",e)})},resetCarousel:function(){const e=document.querySelectorAll(".card img");e&&e.forEach(e=>{e.src=this.onePixelUrl}),this.resetDataImages()},resetDataImages:function(){if(this.carousel)for(let e=0;e<this.carousel.elementsListener.length;e++)this.carousel.elementsListener[e].removeAllEventListener();for(key in this.carousel=null,this.lastBlobImages)"count"!=key&&this.objectURL.revokeObjectURL(key);for(key in this.dataImages=[],this.lastBlobImages={count:[]},this.lastBlobImages2)this.objectURL2.revokeObjectURL(key);this.dataImagesComponent=[],this.dataImagesComponent_backup=[],this.lastBlobImages2={},document.getElementById("input_search").value=""},show3D_Or_List:function(e){e.checked?(document.querySelector(".card-carousel .carousel").style.visibility="hidden",document.querySelector(".map-container .name").style.opacity="0",blackVue.addListImages(blackVue.dataImages)):(document.querySelector(".carousel-container .list").style.display="none",document.querySelector(".map-container .name").style.opacity="1",document.querySelector(".card-carousel .carousel").style.visibility="visible",blackVue.updateBlackName());let t=document.querySelector(".carousel-container .description");t&&t.classList.remove("visible");let a=document.querySelector(".siblinggsCarourel.list .gallery.active");a&&a.classList.remove("active")},hideCarousel:function(t){t.target.classList.contains("ignore")||(this.isViewModeList=!1,document.querySelector("#map span.name").style.display="none",document.querySelector("#map .countryName").style.display="none",document.querySelector("#map .tg-display").classList.remove("active"),document.querySelector(".carousel-container").style.visibility="hidden",document.querySelector(".card-carousel .carousel").style.visibility="hidden",document.querySelectorAll(".rangeYear").forEach(e=>e.classList.remove("active")),document.querySelector(".carousel-container .description").classList.remove("active"),this.resetDataImages(),this.responsiveList(!0)),"INPUT"!=t.target.tagName&&document.querySelectorAll(".rangeYear input").forEach(e=>{e.blur()})},showCarousel:function(e){let t,a;if("hit"==e.type)t=e.target.dataItem.dataContext.name,a=e.target.dataItem.dataContext.id||e.target.dataItem.dataContext.country;else{const r=e.target.querySelector("option:checked");t=r.innerText,a=r.value}a in blackVue.listMarkers&&(!(a in blackVue.listMarkers)||blackVue.listMarkers[a])&&(this.selectCountryName(a),this.resetCarousel(),blackVue.getBlacksByCountry(a).then(function(e){blackVue.dataImages=[];const t=["0","1","-1","2","-2"];if(0!=e.length){for(let a=0;5>a&a<e.length;a++)blackVue.dataImages[a]={"data-x":t[a],url:e[a].image_dataURI,name:e[a].name,extracts:e[a].summary,category:e[a].category,internal_link:e[a].internal_link,wiki_link:e[a].wiki_link};if(0<e.length)for(let t=5;t<e.length;t++)blackVue.dataImages[t]={"data-x":"",url:e[t].image_dataURI,name:e[t].name,extracts:e[t].summary,category:e[t].category,internal_link:e[t].internal_link,wiki_link:e[t].wiki_link};document.querySelector(".carousel-container").style.visibility="initial",document.querySelector("#map .countryName").style.display="block",document.querySelector("#map .tg-display").classList.add("active"),document.querySelector(".carousel-container .description").classList.add("active"),blackVue.countryCode=a,blackVue.isMobile?(blackVue.isViewModeList=!0,blackVue.skipCarousel(),blackVue.responsiveList(),document.querySelector("#map span.name").style.display="none"):(blackVue.carousel=new CardCarousel(blackVue.cardsContainer,blackVue.cardsCarousel,blackVue.cardsController),blackVue.show3D_Or_List(document.getElementById("cb_display")),document.querySelector("#map span.name").style.display="inline-block"),document.documentElement.scrollTop=0}},t=>{console.log("error:",t)}))},clickOutsideMap:function(t){let e="hidden"!=document.querySelector(".carousel-container").style.visibility;e&&null==t.target.closest(".carousel-container")&&(!blackVue.isMobile&&blackVue.carousel&&blackVue.carousel.scrollDirection&&blackVue.carousel.scrollDirection.direction!=null?/iPad/i.test(navigator.userAgent)&&blackVue.carousel&&blackVue.hideCarousel(t):blackVue.hideCarousel(t)),blackVue.carousel&&(blackVue.carousel.scrollDirection={})},skipCarousel:function(){document.getElementById("cb_display").checked=!0,document.getElementById("cb_display").dispatchEvent(new Event("change"))},selectCountryName:function(e){const t=document.querySelector("select.countryName option[value=\""+e+"\"]");t&&(t.closest("select").value=e,this.updateBorderCountry(t))},updateBorderCountry:function(e){const t=window.getComputedStyle(e,null).getPropertyValue("font-family"),a=window.getComputedStyle(e,null).getPropertyValue("font-size"),r=this.getTextWidth(e.innerText,t,a,!0,!0);e.closest("select").style.width=r+25+"px"},getTextWidth:function(e,t,a,r=!1,n=!1){let l=document.createElement("span");l.id="tempTestWidth",l.style.opacity=0,l.style.fontFamily=t,l.style.fontSize=a,l.style.height="auto",l.style.width="auto",l.style.position="absolute",l.style.whiteSpace="no-wrap",l.innerHTML=e,r&&(l.fontWeight="bold"),n&&(l.style.textTransform="uppercase"),document.body.appendChild(l);const s=Math.ceil(l.clientWidth);return document.querySelector("span#tempTestWidth").remove(),s},dataURIToBlob:function(e){if(!e)return;let t=e.indexOf(";base64,")+8,a=e.substring(t),r=window.atob(a),n=r.length,l=new Uint8Array(new ArrayBuffer(n));for(i=0;i<n;i++)l[i]=r.charCodeAt(i);return new Blob([l],{type:"image/jpeg"})},revokeOldBlobImage:function(e){5<this.dataImages.length&&5<=this.lastBlobImages.count.length&&e.startsWith("blob:")&&(this.objectURL.revokeObjectURL(e),delete this.lastBlobImages[e],removeItemArray(this.lastBlobImages.count,e))},getCleanImage:function(e){let t=this.dataURIToBlob(e);this.tempBlobImage=this.objectURL.createObjectURL(t);let a=this.tempBlobImage.toString();return this.lastBlobImages[a]=e,this.lastBlobImages.count.unshift(a),this.updateBlackName(),this.tempBlobImage},dataURIToBlob2:function(e){if(!e)return;let t=e.indexOf(";base64,")+8,a=e.substring(t),r=window.atob(a),n=r.length,l=new Uint8Array(new ArrayBuffer(n));for(i=0;i<n;i++)l[i]=r.charCodeAt(i);return new Blob([l],{type:"image/jpeg"})},getCleanImage2:function(e){let t=this.dataURIToBlob2(e),a=this.objectURL2.createObjectURL(t);return this.lastBlobImages2[a]=this.keyOf(e),a},keyOf:function(e){for(let t=0;t<this.dataImages.length;t++)if(this.dataImages[t].url&&this.dataImages[t].url==e)return{id:t,name:this.dataImages[t].name}},update_lastBlobImages2:function(){for(let e in this.lastBlobImages2){let t=this.lastBlobImages2[e].name;for(let a=0;a<this.dataImages.length;a++)this.dataImages[a].name==t&&(this.lastBlobImages2[e].id=a)}},click_loadNewImage:function(e){if(!(5>=blackVue.dataImages.length)){const t=document.querySelectorAll(".card");if("left"==e){blackVue.dataImages[0]["data-x"]="",blackVue.dataImages.move(0,blackVue.dataImages.length-1);const a=blackVue.dataImages[4].url,r=this.isDuplicate(t,a);if(!r){let e=document.querySelector(".card[data-x=\"-2\"] img");this.revokeOldBlobImage(e.src),e.src=this.getCleanImage(a)}else this.click_loadNewImage(e)}else if("right"==e){blackVue.dataImages[4]["data-x"]="",blackVue.dataImages.move(blackVue.dataImages.length-1,0);const a=blackVue.dataImages[0].url;if(!this.isDuplicate(t,a)){let e=document.querySelector(".card[data-x=\"2\"] img");this.revokeOldBlobImage(e.src),e.src=this.getCleanImage(a)}else this.click_loadNewImage(e)}this.reorderURLS()}},isDuplicate:function(e,t){let a=!1;return e.forEach(e=>{const r=e.querySelector("img").src;r in blackVue.lastBlobImages&&blackVue.lastBlobImages[r]==t&&(a=!0)}),a},reorderURLS:function(){blackVue.dataImages[0]["data-x"]="2",blackVue.dataImages[1]["data-x"]="1",blackVue.dataImages[2]["data-x"]="0",blackVue.dataImages[3]["data-x"]="-1",blackVue.dataImages[4]["data-x"]="-2"},scroll_loadNewImage:function(e){if(5>=blackVue.dataImages.length)return;const t=document.querySelectorAll(".card");let a=0;for(i in t)if("object"==typeof t[i]){let e=t[i].style.opacity;if(e=parseInt(e.replace("px","")),0==e){a=t[i].id;break}}if("left"==e){if(0<a){blackVue.dataImages[4]["data-x"]="",blackVue.dataImages.move(blackVue.dataImages.length-1,0);const r=blackVue.dataImages[0].url;if(!this.isDuplicate(t,r)){let e=document.querySelector(".card[id=\""+a+"\"] img");this.revokeOldBlobImage(e.src),e.src=blackVue.getCleanImage(r)}else this.scroll_loadNewImage(e)}}else if("right"==e&&0<a){blackVue.dataImages[0]["data-x"]="",blackVue.dataImages.move(0,blackVue.dataImages.length-1);const r=blackVue.dataImages[4].url;if(!this.isDuplicate(t,r)){let e=document.querySelector(".card[id=\""+a+"\"] img");this.revokeOldBlobImage(e.src),e.src=blackVue.getCleanImage(r)}else this.scroll_loadNewImage(e)}this.reorderURLS()},facebook:function(){return"https://www.facebook.com/sharer/sharer.php?u="+encodeURIComponent(this.internal_link)},twitter:function(){return"https://twitter.com/intent/tweet?text="+this.blackName+"&url="+encodeURIComponent("\n"+this.internal_link)},whatsapp:function(){return"https://wa.me/?text="+encodeURIComponent(this.internal_link)},updateBlackName:function(){const e=document.querySelector(".card.highlight img");if(e){if(e.src in this.lastBlobImages){const t=this.lastBlobImages[e.src];for(let e=0;e<blackVue.dataImages.length;e++)if(t==blackVue.dataImages[e].url){this.blackName=blackVue.dataImages[e].name,this.extracts=blackVue.shortVersionExtracts(blackVue.dataImages[e].extracts),this.categories=blackVue.dataImages[e].category.join(", "),this.wiki_link=blackVue.dataImages[e].wiki_link||"#",this.internal_link=blackVue.dataImages[e].internal_link,document.querySelector(".carousel-container .description-content p").scrollTop=0;break}}const t=document.querySelectorAll(".card");for(let e=0;e<t.length;e++)t[e].removeEventListener("click",this.toggleDescription);e.closest(".card.highlight").addEventListener("click",this.toggleDescription),e.closest(".card[data-x=\"0\"]")&&e.src!=blackVue.onePixelUrl&&(e.closest(".card[data-x=\"0\"]").style.zIndex="0"),5>this.dataImages.length&&this.skipEmptyImage(e);let a=this.carousel?this.carousel.prev:null,r=this.carousel?this.carousel.next:null;a&&a[0]&&"-3"==a[0].style.zIndex&&(a[0].style.zIndex="-1"),r&&r[1]&&"-3"==r[1].style.zIndex&&(r[1].style.zIndex="-1")}},skipEmptyImage:function(e){blackVue.lastScrollDirection.direction&&e.src==blackVue.onePixelUrl?blackVue.lastScrollDirection.srcChanged&&(blackVue.lastScrollDirection.srcChanged=!1,"left"==blackVue.lastScrollDirection.direction?"click"==blackVue.lastScrollDirection.cursorState?(blackVue.cardsContainer.dispatchEvent(new CustomEvent("prev",{detail:{type:"keyboard"}})),blackVue.lastScrollDirection.srcChanged=!0):"moving"==blackVue.lastScrollDirection.cursorState&&blackVue.cardsContainer.dispatchEvent(new CustomEvent("prev",{detail:{type:"scroll"}})):"right"==blackVue.lastScrollDirection.direction&&("click"==blackVue.lastScrollDirection.cursorState?(blackVue.cardsContainer.dispatchEvent(new CustomEvent("next",{detail:{type:"keyboard"}})),blackVue.lastScrollDirection.srcChanged=!0):"moving"==blackVue.lastScrollDirection.cursorState&&blackVue.cardsContainer.dispatchEvent(new CustomEvent("next",{detail:{type:"scroll"}}))),blackVue.skipEmptyImageAgain()):blackVue.lastScrollDirection.srcChanged=!0},skipEmptyImageAgain:function(){setTimeout(()=>{const e=document.querySelector(".card.highlight img");e&&e.src==blackVue.onePixelUrl?(blackVue.lastScrollDirection.srcChanged=!0,blackVue.lastScrollDirection.cursorState="click",blackVue.skipEmptyImage(e)):e&&e.src!=blackVue.onePixelUrl&&(blackVue.lastScrollDirection.srcChanged=!1)},100)},toggleDescription:function(t){if("image-card"==t.target.className){if("moving"==this.lastScrollDirection.cursorState)return;document.querySelector(".carousel-container .description").classList.toggle("visible")}else["share","shareLogo"].includes(t.target.className)&&this.toggleShareModal(t)},skipEventCard:function(t){return!!["share","shareLogo"].includes(t.target.className)},toggleShareModal:function(t){t.stopPropagation();const e=document.getElementById("share-modal");t.target.closest("#showcase")?this.toggleModal(e,t.target.closest("#showcase")):this.toggleModal(e),document.querySelector("#showcase.active")?document.querySelector("#share-modal button[name=\"show\"]").classList.add("hidden"):document.querySelector("#share-modal button[name=\"show\"]").classList.remove("hidden")},shareModalClick:function(t){if(event.stopPropagation(),t.target.classList.contains("modal"))this.toggleModal(t.target);else if("button"==t.target.type)if("copy"==t.target.name){const e=document.querySelector("#share-modal .shareLink input");if(""==e.value)return;e.select(),document.execCommand("copy")}else if("show"==t.target.name){const e=document.querySelector("#share-modal .shareLink input").value.replace(/.+\//,"");this.getShowcaseData(e)}},updateSlug:function(e=!1){const t=document.querySelector("#openShowcase");e?(t&&(t.innerHTML="#"+this.slug),window.history.pushState&&history.replaceState(null,null,"/")):(t&&(t.innerHTML=""),window.history.pushState&&history.replaceState(null,null,this.slug))},showcase:function(e){"click"==e.type&&e.target.classList.contains("modal")?(e.stopPropagation(),this.toggleModal(e.target),this.updateSlug(!0)):e.classList&&e.classList.contains("modal")&&(this.toggleModal(e),this.updateSlug()),document.querySelector(".container").style.opacity="1",document.querySelector("#showcase").style.backgroundColor="transparent"},getShowcaseData:function(e,t=!1){const a=document.querySelector("#showcase");t?(this.processShowcaseData(a,t),this.slug=e):this.postAxios(window.location.origin+"/getGreatBlack/",{slug:decodeURIComponent(e)},function(e){a.classList.remove("active"),e.data&&"success"==e.data.status&&0<e.data.data.length&&(blackVue.closeOtherStuff(a),document.querySelector("#menuLinks a[data-link=\"greatblacks\"]").click(),blackVue.slug=e.data.slug,blackVue.processShowcaseData(a,e.data.data[0]))})},processShowcaseData:function(e,t){e.querySelector(".name h2").innerHTML=t.name,e.querySelector(".born td:nth-child(3)").innerHTML=t.birth_date||t.birth_year,e.querySelector(".death td:nth-child(3)").innerHTML=t.death_date||t.death_year,this.isDeath=!!(t.death_date||t.death_year),e.querySelector(".category td:nth-child(3)").innerHTML=t.category.join(", "),e.querySelector(".country td:nth-child(3)").innerHTML=this.longVersionCountry(t.countries).join(", "),e.querySelector(".extracts p").innerHTML=this.shortVersionExtracts(t.summary),e.querySelector(".more a").innerHTML="more",e.querySelector(".more a").href=t.wiki_link,this.internal_link=t.internal_link;let a=document.querySelector("#showcase .image img");a.onload=function(){e.classList.contains("active")||(blackVue.showcase(e),document.getElementById("preloading")&&document.getElementById("preloading").remove())},a.src=this.getCleanImage(t.image_dataURI)},longVersionCountry:function(e){const t=document.querySelectorAll(".map-container select[name=\"country\"] option");for(let a=0;a<e.length;a++)for(let r=0;r<t.length;r++)e[a]==t[r].value&&(e[a]=t[r].textContent);return e},shortVersionExtracts:function(e){return 1e3<e.length?e.substring(0,1e3)+" ...":e},isOnTimeLine:function(e,t){let a=!1;return null==t&&(t=this.currentYear),null==this.queryPeriod[0]&&null==this.queryPeriod[1]?a=!0:null==this.queryPeriod[0]&&null!=this.queryPeriod[1]?(e<=this.queryPeriod[1]||t<=this.queryPeriod[1])&&(a=!0):null!=this.queryPeriod[0]&&null==this.queryPeriod[1]?(e>=this.queryPeriod[0]||t>=this.queryPeriod[0])&&(a=!0):null!=this.queryPeriod[0]&&null!=this.queryPeriod[1]&&((e>=this.queryPeriod[0]&&e<=this.queryPeriod[1]||t>=this.queryPeriod[0]&&t<=this.queryPeriod[1])&&(a=!0),e<=this.queryPeriod[0]&&t>=this.queryPeriod[1]&&(a=!0),e>=this.queryPeriod[0]&&t<=this.queryPeriod[1]&&(a=!0)),a},changePeriode:function(t){if(!(10<t.target.value.toString().length)){try{let e,a=null,r=document.querySelector(".rangeYear input[name=\"from\"]"),n=document.querySelector(".rangeYear input[name=\"to\"]");if(e=""==r.value?null:parseInt(r.value),a=""==n.value?null:parseInt(n.value),e>this.currentYear&&(e=this.currentYear,r.value=this.currentYear),a>this.currentYear&&(a=this.currentYear,n.value=this.currentYear),""!=r.value&&""!=n.value&&parseInt(r.value)>parseInt(n.value))return r.style.border="1px solid red",void(n.style.border="1px solid red");r.style.border="",n.style.border="",this.queryPeriod[0]=e,this.queryPeriod[1]=a}catch(t){return}this.updateStatusCountry()}},changeCategory:function(t){const e=t.target.closest("form").id.replace("cat_","");t.target.checked&&!this.queryCategory.includes(e)?this.queryCategory.push(e):removeItemArray(this.queryCategory,e),this.updateStatusCountry()},updateStatusCountry:function(){for(let e in this.listMarkers)this.listMarkers.hasOwnProperty(e)&&(this.listMarkers[e]=!1);let e=Object.keys(blackVue.listMarkers);for(let t=0;t<this.blacksData.length;t++)if(this.isOnTimeLine(this.blacksData[t].birth_year,this.blacksData[t].death_year))for(let a=0;a<e.length;a++)this.blacksData[t].countries.includes(e[a])&&this.blacksData[t].category.some(e=>blackVue.queryCategory.includes(e))&&(this.listMarkers[e[a]]=!0,removeItemArray(e,e[a]));this.updateMarkers()},updateMarkers:function(){const e=chart.map.getKey("markers");e.mapImages.each(function(e){e.country in blackVue.listMarkers?!1==blackVue.listMarkers[e.country]?e.hide():e.show():e.hide()})},toggleViewMode:function(t){this.show3D_Or_List(t.target),document.getElementById("cb_display").checked?(this.isViewModeList=!0,document.querySelector("#map span.name").style.display="none",document.getElementById("input_search").value="",this.update_lastBlobImages2(),this.filterSearch()):(document.querySelector(".carousel-container .siblinggsCarourel.list").scrollTop=0,document.querySelector("#map span.name").style.display="inline-block",this.isViewModeList=!1,this.dataImagesComponent=[],this.dataImagesComponent_backup=[]),(this.isMobile||/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))&&(this.isViewModeList=!0)},filterSearch:function(){const e=this.filterSearchValue;if(!e)return 0==this.dataImagesComponent_backup.length?this.dataImagesComponent_backup=this.dataImagesComponent:this.dataImagesComponent=this.dataImagesComponent_backup,void(this.dataImages_lastIndex=this.dataImagesComponent.length);else{this.dataImages_lastIndex=this.dataImages.length;let e=document.querySelector(".siblinggsCarourel.list .gallery.active");e&&e.classList.remove("active");let t=document.querySelector(".siblinggsCarourel.description.active.visible");t&&t.classList.remove("visible")}this.dataImagesComponent=[];let t=0,a=[];for(let r=0;r<this.dataImages.length&&!(4>t&&new RegExp(e,"i").test(this.dataImages[r].name)&&(a.push(this.dataImages[r]),t++,4<=t));r++);if(0<a.length){let e=this.changeDataUriToBlob(a);this.dataImagesComponent=e}},responsiveList:function(e=!1){if(this.isMobile){let t=document.querySelector(".map-container");return t.style.overflow="hidden",!0==e||this.dataImages&&0==this.dataImages.length?void(t.style.height="100%"):void(t&&(500<t.clientWidth?t.style.height="900px":t&&690<t.clientHeight?t.style.height="100%":t.style.height="690px"))}},getBlacksByCountry:function(e){return new Promise((t,a)=>{if(!e||0>=this.queryCategory.length||0>=this.queryPeriod)return void a();const r={country:e,category:this.queryCategory,period:this.queryPeriod};this.postAxios(window.location.origin+"/getBlacksByCountry/",r,function(e){e.data&&"success"==e.data.status?t(e.data.query):a(null)})})}},computed:{cardHighlighted(){return this.carousel?this.carousel.cardHighlighted:null}},watch:{cardHighlighted(){const e=document.querySelector(".card.highlight img");e&&e.src==this.onePixelUrl&&(blackVue.lastScrollDirection.srcChanged=!0),this.updateBlackName()}},mounted(){!0==this.authenticated&&this.getUserData();let e=document.querySelector("#json_string_blackValues");if(e){const t=window.location.href.replace(window.location.origin+"/","").replace(/(#|\?).*/,"").trim();t.match(/.+/)&&(e=JSON.parse(e.innerText),0<Object.keys(e).length&&this.getShowcaseData(decodeURIComponent(t),e))}window.addEventListener("resize",function(){/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||500>document.querySelector(".carousel-container").clientWidth?(blackVue.isMobile=!0,blackVue.skipCarousel()):blackVue.isMobile=!1;let e=document.querySelector("select.countryName option:checked");e&&blackVue.updateBorderCountry(e),blackVue.responsiveList()}),window.addEventListener("click",function(t){t.stopPropagation(),500<Date.now()-blackVue.openPolygon_timeStamp&&blackVue.clickOutsideMap(t)})}});function checkWikiData1(e){try{blackVue.checkWikiData1(e)}catch(t){console.error(t),blackVue.afterWikiRequest("show","An error occured please try another link.",!0)}}function checkWikiImage2(e){try{blackVue.checkWikiImage2(e)}catch(t){console.error(t),blackVue.afterWikiRequest("show","An error occured please try another link.",!0)}}am4core.useTheme(am4themes_dark),am4core.useTheme(am4themes_animated);let chart=am4core.create("chartdiv",am4maps.MapChart);chart.preloader.disabled=!0,chart.geodata=am4geodata_worldLow,chart.projection=new am4maps.projections.Miller;let polygonSeries=chart.series.push(new am4maps.MapPolygonSeries);polygonSeries.exclude=["AQ"],polygonSeries.useGeodata=!0;let polygonTemplate=polygonSeries.mapPolygons.template;polygonTemplate.tooltipText="{name}",polygonTemplate.polygon.fillOpacity=1;let hs=polygonTemplate.states.create("hover");hs.properties.fill=am4core.color("#FFFFFF");const orange="#FF8726";let imageSeries=chart.series.push(new am4maps.MapImageSeries);imageSeries.id="markers";let imageSeriesTemplate=imageSeries.mapImages.template;imageSeriesTemplate.propertyFields.horizontalCenter="middle",imageSeries.mapImages.template.propertyFields.verticalCenter="middle",imageSeriesTemplate.propertyFields.longitude="longitude",imageSeriesTemplate.propertyFields.latitude="latitude",imageSeriesTemplate.propertyFields.country="country",imageSeriesTemplate.propertyFields.name="name",imageSeriesTemplate.nonScaling=!0,imageSeriesTemplate.tooltipText="{name}",imageSeriesTemplate.fill=am4core.color("#313131"),imageSeriesTemplate.background.fillOpacity=.6,imageSeriesTemplate.background.fill=am4core.color("#ffffff"),imageSeriesTemplate.states.create("hover");let circle=imageSeriesTemplate.createChild(am4core.Circle);circle.radius=3,circle.fill=am4core.color("#FF8726");try{const e=JSON.parse(document.querySelector("#listCountries").innerText);imageSeries.data=e}catch{console.log("JSON Error: data for imageSeries not initialized.")}let buttonsAndChartContainer=chart.createChild(am4core.Container);buttonsAndChartContainer.layout="vertical",buttonsAndChartContainer.height=/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||500>document.querySelector(".carousel-container").clientWidth?155:120,buttonsAndChartContainer.width=am4core.percent(100),buttonsAndChartContainer.valign="bottom";let showcaseLabel=buttonsAndChartContainer.createChild(am4core.Label);showcaseLabel.html="<span id=\"openShowcase\">&nbsp;</span>",showcaseLabel.fontSize=12,showcaseLabel.align="left",showcaseLabel.fill="grey";let chartAndSliderContainer=buttonsAndChartContainer.createChild(am4core.Container);chartAndSliderContainer.layout="vertical",chartAndSliderContainer.height=am4core.percent(10),chartAndSliderContainer.width=am4core.percent(100),chartAndSliderContainer.background=new am4core.RoundedRectangle,chartAndSliderContainer.background.fill=am4core.color("#000000"),chartAndSliderContainer.background.cornerRadius(30,30,0,0),chartAndSliderContainer.background.fillOpacity=.25,chartAndSliderContainer.paddingTop=12,chartAndSliderContainer.paddingBottom=0;let label=chartAndSliderContainer.createChild(am4core.Label);label.text="TIME LINE",label.fontSize=12,label.align="center",label.fill="grey";let sliderContainer=chartAndSliderContainer.createChild(am4core.Container);sliderContainer.width=am4core.percent(100),sliderContainer.padding(0,15,15,10),sliderContainer.layout="horizontal";let slider=sliderContainer.createChild(am4core.Slider);slider.width=am4core.percent(100),slider.valign="middle",slider.background.opacity=.4,slider.opacity=.7,slider.background.fill=am4core.color("#ffffff"),slider.marginLeft=20,slider.marginRight=35,slider.height=15,slider.start=1,slider.showSystemTooltip=!1;let playButton=sliderContainer.createChild(am4core.PlayButton);playButton.valign="middle",playButton.events.on("toggled",function(e){e.target.isActive?play():stop()}),playButton.background.fill=am4core.color("#FF8726"),slider.startGrip.background.fill=playButton.background.fill,slider.startGrip.background.strokeOpacity=0,slider.startGrip.icon.stroke=am4core.color("#ffffff"),slider.startGrip.background.states.copyFrom(playButton.background.states);let checkboxContainer=chartAndSliderContainer.createChild(am4core.Container);checkboxContainer.width=0,checkboxContainer.height=0,checkboxContainer.padding(0,15,15,10),checkboxContainer.layout="horizontal",checkboxContainer.fill="#fff",checkboxContainer.align="center";let label2=checkboxContainer.createChild(am4core.Label);label2.text="categories",label2.fontSize=0,label2.align="center",label2.fill="#000000";let sliderAnimation,slideStatus=0,slideStatusInterval=null;slider.startGrip.events.on("drag",()=>{stop(),sliderAnimation&&sliderAnimation.setProgress(slider.start)});function play(){sliderAnimation||(sliderAnimation=slider.animate({property:"start",to:1,from:0},1e4,am4core.ease.linear).pause(),sliderAnimation.events.on("animationended",()=>{playButton.isActive=!1})),1<=slider.start&&(slider.start=0,sliderAnimation.start()),sliderAnimation.resume(),playButton.isActive=!0}function stop(){sliderAnimation&&(sliderAnimation.pause(),document.querySelectorAll(".rangeYear").forEach(e=>{e.classList.remove("active")})),playButton.isActive=!1}polygonTemplate.events.on("hit",function(e){e.event.stopPropagation(),blackVue.openPolygon_timeStamp=Date.now(),blackVue.showCarousel(e),document.querySelectorAll(".rangeYear").forEach(e=>e.classList.add("active"))}),imageSeriesTemplate.events.on("hit",function(e){e.event.stopPropagation(),blackVue.openPolygon_timeStamp=Date.now(),blackVue.showCarousel(e)}),polygonSeries.events.on("beforedatavalidated",function(){if(!blackVue.beforedatavalidated){blackVue.beforedatavalidated="done",blackVue.cardsContainer=document.querySelector(".card-carousel"),blackVue.cardsCarousel=document.querySelector(".card-carousel .carousel"),blackVue.cardsController=document.querySelector(".card-carousel + .card-controller"),blackVue.listMarkers=[];try{const e=JSON.parse(document.getElementById("json_string_listMarkers").innerText);blackVue.blacksData=e,document.getElementById("json_string_listMarkers").remove();for(let t=0;t<e.length;t++){e[t].birth_year&&!blackVue.timeLine.includes(e[t].birth_year)&&blackVue.timeLine.push(e[t].birth_year),e[t].death_year&&!blackVue.timeLine.includes(e[t].death_year)&&blackVue.timeLine.push(e[t].death_year);for(let a=0;a<e[t].countries.length;a++)e[t].countries[a]in blackVue.listMarkers||(blackVue.listMarkers[e[t].countries[a]]=!0)}blackVue.timeLine.sort(function(e,t){return e-t})}catch(t){console.log("JSON Error: listMarkers",t)}}else blackVue.updateMarkers()}),chart.events.on("ready",()=>{blackVue.updateMarkers(),document.getElementById("preloading")&&document.getElementById("preloading").remove(),document.querySelectorAll("select.countryName option").forEach(e=>{e.value in blackVue.listMarkers||e.remove()});let e,t;document.querySelectorAll("tspan").forEach(a=>{"TIME LINE"==a.textContent&&(e=a.closest("g[fill]")),"categories"==a.textContent&&(t=a.closest("g[fill]"),a.closest("g[style]").remove())});let a=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");a.setAttribute("width",80),a.setAttribute("height",25),a.setAttribute("x",70),a.setAttribute("y",-3);let r=document.createElement("FORM");r.className="rangeYear";let n=document.createElement("INPUT");n.type="number",n.name="to",n.onchange=function(t){t.stopPropagation(),blackVue.changePeriode(t)},r.appendChild(n),a.appendChild(r);let l=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");l.setAttribute("width",80),l.setAttribute("height",25),l.setAttribute("x",-90),l.setAttribute("y",-3);let s=document.createElement("FORM");s.className="rangeYear";let o=document.createElement("INPUT");o.type="number",o.name="from",o.onchange=function(t){t.stopPropagation(),blackVue.changePeriode(t)},s.appendChild(o),l.appendChild(s),e.prepend(a),e.prepend(l);let c,d,u,g,m,y,p;/Android|webOS|iPhone|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||500>document.querySelector(".carousel-container").clientWidth?(c=createCheckbox_foreignObject(78,25,-160,-10,"cat_activist","Activist"),d=createCheckbox_foreignObject(90,25,-80,-10,"cat_scientist","Scientist"),u=createCheckbox_foreignObject(70,25,13,-10,"cat_politic","Politic"),g=createCheckbox_foreignObject(50,25,85,-10,"cat_art","Art"),m=createCheckbox_foreignObject(65,25,-160,23,"cat_sport","Sport"),y=createCheckbox_foreignObject(85,25,-80,23,"cat_spiritual","Spiritual"),p=createCheckbox_foreignObject(70,25,13,23,"cat_other","Other"),blackVue.responsiveList(!0)):(c=createCheckbox_foreignObject(78,25,-290,-10,"cat_activist","Activist"),d=createCheckbox_foreignObject(90,25,-200,-10,"cat_scientist","Scientist"),u=createCheckbox_foreignObject(70,25,-100,-10,"cat_politic","Politic"),g=createCheckbox_foreignObject(50,25,-20,-10,"cat_art","Art"),m=createCheckbox_foreignObject(65,25,40,-10,"cat_sport","Sport"),y=createCheckbox_foreignObject(85,25,120,-10,"cat_spiritual","Spiritual"),p=createCheckbox_foreignObject(70,25,220,-10,"cat_other","Other")),t.prepend(c),t.prepend(d),t.prepend(u),t.prepend(g),t.prepend(m),t.prepend(y),t.prepend(p);let h=document.querySelector(".rangeYear input[name=from]"),k=document.querySelector(".rangeYear input[name=to]");slider.events.on("rangechanged",function(){let e=Math.round((blackVue.timeLine.length-1)*slider.start);document.querySelectorAll(".rangeYear").forEach(e=>{e.classList.add("active")}),e<blackVue.timeLine.length-1&&(h.value=blackVue.timeLine[e],k.value=blackVue.timeLine[e+1],h.dispatchEvent(new Event("change")),k.dispatchEvent(new Event("change")),null==slideStatusInterval&&(slideStatusInterval=setInterval(function(){1==slideStatus&&(clearInterval(slideStatusInterval),slideStatusInterval=null,setTimeout(()=>{1==slider.start&&(slideStatus=0,h.value="",k.value="",h.dispatchEvent(new Event("change")),k.dispatchEvent(new Event("change")))},1e3),document.querySelectorAll(".rangeYear").forEach(e=>{e.classList.remove("active")})),slideStatus=1},500)),slideStatus=0)});const f=document.getElementById("openShowcase");f&&(f.closest("foreignObject").style.width="100%",f.onclick=function(){blackVue.showcase(document.querySelector("#showcase")),window.history.pushState&&history.replaceState(null,null,blackVue.slug)})});function createCheckbox_foreignObject(e,t,a,r,n,l){let s=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");s.setAttribute("width",e),s.setAttribute("height",t),s.setAttribute("x",a),s.setAttribute("y",r);let o=document.createElement("FORM");return o.id=n,o.className="categories",o.innerHTML="<label class=\"container-checkbox\">"+l+"<input type=\"checkbox\" checked=\"checked\"><span class=\"checkmark\"></span></label>",o.onclick=function(t){t.stopPropagation(),"INPUT"==t.target.tagName&&blackVue.changeCategory(t)},s.appendChild(o),s}class DraggingEvent{constructor(e=void 0,t=void 0){this.target=e,this.carousel=t,this.prev=null,this.next=null,this.leftPosLastCards={left:{id:"",leftPos:101},right:{id:"",leftPos:0}},this.left_lastCard=null,this.right_lastCard=null,this.scrollDirection={},this.cardHighlighted="3",this.cursorState=0,this.elementsListener=[e,t,document.body,blackVue.cardsController]}event(t,a=this){let r;this.target.addEventListener("mousedown",n=>{function e(){a.carousel.removeEventListener("mousemove",r),document.body.removeEventListener("mouseleave",e),document.body.removeEventListener("mouseup",e),r(null),a.updateControllerLinks(),a.updateScrollDirection(event)}n.preventDefault();blackVue.skipEventCard(n)||(r=t(n),a.carousel.addEventListener("mousemove",r),document.body.addEventListener("mouseleave",e),document.body.addEventListener("mouseup",e))}),this.target.addEventListener("touchstart",n=>{function e(){a.carousel.removeEventListener("touchmove",r),document.body.removeEventListener("touchend",e),document.body.removeEventListener("mouseleave",e),r(null),a.updateScrollDirection(event)}blackVue.skipEventCard(n)||(r=t(n),a.carousel.addEventListener("touchmove",r),document.body.addEventListener("touchend",e),document.body.addEventListener("mouseleave",e))},{passive:!0})}updateScrollDirection(t){this.scrollDirection.end=this.getStartingPoint(t)[0],this.cursorState="moving",blackVue.lastScrollDirection.cursorState="moving",0<this.scrollDirection.start-this.scrollDirection.end?(this.scrollDirection.direction="left",blackVue.lastScrollDirection.direction="left"):0>this.scrollDirection.start-this.scrollDirection.end?(this.scrollDirection.direction="right",blackVue.lastScrollDirection.direction="right"):(this.cursorState="click",blackVue.lastScrollDirection.cursorState="click")}updateControllerLinks(){document.querySelectorAll(".card[data-x]").forEach(e=>{e.onclick=null}),this.prev=document.querySelectorAll(".card[data-x=\"1\"], .card[data-x=\"2\"]"),this.next=document.querySelectorAll(".card[data-x=\"-1\"], .card[data-x=\"-2\"]");let e=this;0<this.prev.length&&this.prev.forEach(t=>{5>blackVue.dataImages.length&&t.querySelector(".image-card").src==blackVue.onePixelUrl&&(t.style.zIndex="-3"),t.onclick=function(){blackVue.lastScrollDirection.direction="left","click"==e.cursorState&&t.querySelector(".image-card").src!=blackVue.onePixelUrl&&e.target.dispatchEvent(new CustomEvent("prev",{detail:{type:"keyboard"}}))}}),0<this.next.length&&this.next.forEach(t=>{5>blackVue.dataImages.length&&t.querySelector(".image-card").src==blackVue.onePixelUrl&&(t.style.zIndex="-3"),t.onclick=function(){blackVue.lastScrollDirection.direction="right","click"==e.cursorState&&t.querySelector(".image-card").src!=blackVue.onePixelUrl&&e.target.dispatchEvent(new CustomEvent("next",{detail:{type:"keyboard"}}))}});let t=document.querySelector(".card[data-x=\"0\"]");5>blackVue.dataImages.length&&t.querySelector(".image-card").src==blackVue.onePixelUrl&&(t.style.zIndex="-3")}getStartingPoint(e){let t,a;return"touches"in e?0<e.touches.length?(t=e.touches[0].clientX,a=e.touches[0].clientY):(t=e.changedTouches[0].clientX,a=e.changedTouches[0].clientY):(t=e.clientX,a=e.clientY),[t,a]}getDistance(e){let t=this;this.event(function(a){let[r,n]=t.getStartingPoint(a);return t.scrollDirection.start=r,function(t){return null===t?e(null):"touches"in t?e({x:t.touches[0].clientX-r,y:t.touches[0].clientY-n}):e({x:t.clientX-r,y:t.clientY-n})}})}}class CardCarousel extends DraggingEvent{constructor(e,t=void 0,a=void 0){if(super(e,t),this.container=e,this.controllerElement=a,this.cards=e.querySelectorAll(".card"),this.centerIndex=(this.cards.length-1)/2,this.cardWidth=100*(this.cards[0].offsetWidth/this.container.offsetWidth),this.xScale={},window.removeEventListener("resize",this.updateCardWidth.bind(this)),window.addEventListener("resize",this.updateCardWidth.bind(this)),this.controllerElement){let t=this.controllerElement;t.addEventListener("keydown",this.controller.bind(this)),this.target.addEventListener("prev",function(a){"keyboard"==a.detail.type?t.dispatchEvent(new KeyboardEvent("keydown",{key:"",keyCode:"39"})):"scroll"==a.detail.type&&t.dispatchEvent(new KeyboardEvent("keydown",{key:"",keyCode:"0"}))}),this.target.addEventListener("next",function(a){"keyboard"==a.detail.type?t.dispatchEvent(new KeyboardEvent("keydown",{key:"",keyCode:"37"})):"scroll"==a.detail.type&&t.dispatchEvent(new KeyboardEvent("keydown",{key:"",keyCode:"0"}))}),this.controllerElement.focus(),document.querySelector(".card-carousel").classList.add("smooth-return")}this.build(),super.getDistance(this.moveCards.bind(this))}updateCardWidth(){this.cardWidth=100*(this.cards[0].offsetWidth/this.container.offsetWidth),this.build()}build(e=0){for(let t=0;t<this.cards.length;t++){const e=t-this.centerIndex,a=this.calcScale(e),r=this.calcScale2(e),n=-Math.abs(t-this.centerIndex),l=this.calcPos(e,r);this.xScale[e]=this.cards[t],this.updateCards(this.cards[t],{x:e,scale:a,leftPos:l,zIndex:n})}this.updateControllerLinks(),this.loadFirstImages()}loadFirstImages(){for(let e=0;5>e&e<blackVue.dataImages.length;e++)"0"==blackVue.dataImages[e]["data-x"]?document.querySelector(".card[data-x=\"0\"] img").src=blackVue.getCleanImage(blackVue.dataImages[e].url):"1"==blackVue.dataImages[e]["data-x"]?document.querySelector(".card[data-x=\"1\"] img").src=blackVue.getCleanImage(blackVue.dataImages[e].url):"-1"==blackVue.dataImages[e]["data-x"]?document.querySelector(".card[data-x=\"-1\"] img").src=blackVue.getCleanImage(blackVue.dataImages[e].url):"2"==blackVue.dataImages[e]["data-x"]?document.querySelector(".card[data-x=\"2\"] img").src=blackVue.getCleanImage(blackVue.dataImages[e].url):"-2"==blackVue.dataImages[e]["data-x"]&&(document.querySelector(".card[data-x=\"-2\"] img").src=blackVue.getCleanImage(blackVue.dataImages[e].url));if(5<blackVue.dataImages.length){let e=blackVue.dataImages[0],t=blackVue.dataImages[1],a=blackVue.dataImages[2],r=blackVue.dataImages[3],n=blackVue.dataImages[4];blackVue.dataImages[0]=r,blackVue.dataImages[1]=t,blackVue.dataImages[2]=e,blackVue.dataImages[3]=a,blackVue.dataImages[4]=n}const e=document.querySelectorAll(".card");for(let t=0;t<e.length;t++)this.elementsListener.push(e[t])}controller(t){const e={...this.xScale};if(39===t.keyCode)for(let t in this.xScale){const a=parseInt(t)-1<-this.centerIndex?this.centerIndex:parseInt(t)-1;e[a]=this.xScale[t]}if(37==t.keyCode)for(let t in this.xScale){const a=parseInt(t)+1>this.centerIndex?-this.centerIndex:parseInt(t)+1;e[a]=this.xScale[t]}for(let a in this.xScale=e,e){const e=this.calcScale(a),t=this.calcScale2(a),r=this.calcPos(a,t),n=-Math.abs(a);this.updateCards(this.xScale[a],{x:a,scale:e,leftPos:r,zIndex:n})}(39===t.keyCode||37==t.keyCode)&&(this.updateControllerLinks(),5<blackVue.dataImages.length&&(39===t.keyCode?blackVue.click_loadNewImage("right"):37===t.keyCode&&blackVue.click_loadNewImage("left"),self.left_lastCard==document.querySelector(".card[data-x=\"-2\"]"),self.left_lastCard=document.querySelector(".card[data-x=\"-2\"]"),self.right_lastCard==document.querySelector(".card[data-x=\"2\"]"),self.right_lastCard=document.querySelector(".card[data-x=\"2\"]")))}calcPos(e,t){let a;return 0>e?(a=(100*t-this.cardWidth)/2,a):0<e?(a=100-(100*t+this.cardWidth)/2,a):(a=100-(100*t+this.cardWidth)/2,a)}updateCards(e,t){(t.x||0==t.x)&&e.setAttribute("data-x",t.x),(t.scale||0==t.scale)&&(e.style.transform=`scale(${t.scale})`,e.style.opacity=0==t.scale?t.scale:1),t.leftPos&&(e.style.left=`${t.leftPos}%`),(t.zIndex||0==t.zIndex)&&(0==t.zIndex?(this.cardHighlighted!=e.id&&this.xScale[0]==e&&(this.cardHighlighted=e.id,this.updateScrollDirection(event),"moving"==this.cursorState&&"right"==this.scrollDirection.direction?blackVue.scroll_loadNewImage("right"):"moving"==this.cursorState&&"left"==this.scrollDirection.direction&&blackVue.scroll_loadNewImage("left")),e.classList.add("highlight")):e.classList.remove("highlight"),e.style.zIndex=t.zIndex)}calcScale2(e){let t;return 0>=e?(t=1- -1/5*e,t):0<e?(t=1-1/5*e,t):void 0}calcScale(e){const t=1-1/5*Math.pow(e,2);return 0>=t?0:t}checkOrdering(e,t,a){const r=parseInt(e.dataset.x),n=Math.round(a);let l=t;t!==t+n&&(t+n>r?t+n>this.centerIndex&&(l=t+n-1-this.centerIndex-n+-this.centerIndex):t+n<r&&t+n<-this.centerIndex&&(l=t+n+1+this.centerIndex-n+this.centerIndex),this.xScale[l+n]=e);const s=-Math.abs(l+n);return this.updateCards(e,{zIndex:s}),l}moveCards(e){let t;if(null!=e)this.container.classList.remove("smooth-return"),t=e.x/250;else for(let e in this.container.classList.add("smooth-return"),t=0,this.xScale)this.updateCards(this.xScale[e],{x:e,zIndex:Math.abs(Math.abs(e)-this.centerIndex)});for(let a=0;a<this.cards.length;a++){const e=this.checkOrdering(this.cards[a],parseInt(this.cards[a].dataset.x),t),r=this.calcScale(e+t),n=this.calcScale2(e+t),l=this.calcPos(e+t,n);this.updateCards(this.cards[a],{scale:r,leftPos:l})}}}Array.prototype.move=function(e,t){this.splice(t,0,this.splice(e,1)[0])};function removeItemArray(e,t){let a=e.indexOf(t);-1<a&&e.splice(a,1)}